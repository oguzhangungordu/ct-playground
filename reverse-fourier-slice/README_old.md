# CT Playground

A collection of experiments around Computed Tomography (CT) reconstruction using various techniques.

## Repository Structure

- `baby-ct/` - Basic CT reconstruction experiments using neural networks and classical approaches
- `reverse-fourier-slice/` - Experiments comparing real-space CT projection with Fourier slice theorem implementation

## Baby CT Experiments (`baby-ct/retrivial.ipynb`)

This notebook contains three basic experiments on image reconstruction:

### 1. Phase Retrieval with MNIST

- **Mathematical Formulation**: 
  - Forward model: y_m = | ⟨a_m, x⟩ |² where:
    - x ∈ ℝⁿ is the flattened image vector (784 dimensions)
    - a_m are random Gaussian measurement vectors
    - y_m are the squared magnitudes of the measurements
  - The problem of recovering x from y is called "phase retrieval"

- **Implementation**:
  - Uses a subset of MNIST (5000 training, 1000 test images)
  - Random Gaussian sensing matrix A with 200 measurements per image
  - Neural network with architecture: Linear(200→512) → ReLU → Linear(512→512) → ReLU → Linear(512→784) → Sigmoid

- **Results**: The network learns to reconstruct the original images from phase-less measurements, demonstrated with visual examples.

### 2. CT Reconstruction from Sinograms using Neural Networks

- **Mathematical Formulation**:
  - Forward model: y = Rx where:
    - R represents the Radon transform operator
    - x is the 2D image (Shepp-Logan phantom with variations)
    - y is the sinogram measurement
  - Network learns the inverse mapping: x̂ = f_θ(y)

- **Implementation**:
  - Generates varied Shepp-Logan phantoms with random rotations, shifts, and intensity scaling
  - Simulates CT measurements via the Radon transform across multiple angles
  - Network architecture: Linear(input_dim→1024) → ReLU → Linear(1024→1024) → ReLU → Linear(1024→output_dim) → Sigmoid

- **Results**: Visual comparison between true phantoms and the network's reconstructions.

### 3. Filtered Back-Projection (FBP)

- **Mathematical Formulation**:
  - Based on the inverse Radon transform formula:
    - x(r,φ) = ∫₀ᵗ R⁻¹{g(t,θ)} dθ
    - Where R⁻¹ applies ramp filtering in the frequency domain and backprojects the result

- **Implementation**:
  - Uses a single Shepp-Logan phantom
  - Computes the sinogram using the Radon transform
  - Applies filtered back-projection using the iradon function
  - Visualizes the original image, sinogram, and reconstruction

## Reverse Fourier Slice Comparison (`reverse-fourier-slice/tigre_vs_reverse_fourier.ipynb`)

This notebook explores the relationship between the Radon transform and the Fourier slice theorem as we discussed 2 weeks ago.

- **Mathematical Foundation**:
  The Fourier Slice Theorem states that the 1D Fourier transform of a projection at angle θ equals a slice through the 2D Fourier transform of the image at the same angle.
  
  Mathematically: ℱ₁{Rₓf(t,θ)} = ℱ₂{f}(ω·cos θ, ω·sin θ)

- **Implementation Details**:
  1. Loads and pads a Shepp-Logan phantom
  2. Computes the 2D FFT of the padded image
  3. For a range of angles (10° to 170° in 10° increments):
     - Computes the real-space projection using TIGRE (and skimage.radon for validation as it looks more promising)
     - Extracts a line from the 2D FFT at the same angle
     - Applies a 1D inverse FFT to get a projection
     - Compares both methods visually and using MSE

- **Sinogram Comparison**:
  - Builds complete sinograms (0° to 179°) using both methods
  - Visualizes and compares the resulting sinograms side-by-side

- **Results**: 
  The sinogram generated by TIGRE doesn't match the expected patterns seen in standard CT papers, suggesting that parameter adjustments are needed for the TIGRE geometry configuration. 
  
  However, the Fourier slice method produces a visually correct sinogram. The 1D projections from scikit-image and our Fourier slice method show some agreement at some angles, with some phase differences coming from interpolation issues during the 2D Fourier domain slicing.
  
  Future improvements include:
  - Adjusting TIGRE parameters to produce more accurate real-space projections using TIGRE instead of scikit-image
  - Increasing frequency resolution in FFT operations to reduce possible errors coming from the slcing operation in 2D frequency domain
  - Developing a more precise slicing method for the 2D frequency domain

## Dependencies

- PyTorch
- NumPy
- scikit-image
- TIGRE (for the Fourier slice experiments)
- Matplotlib